<?php    header ( "Content-type:text/html;charset=utf-8" );    $con = mysqli_connect("localhost","root","");        if (!$con)      {      die('Could not connect: ' . mysql_error());      }        mysqli_select_db($con,'wbdata');    mysqli_query($con,'set names utf8');    // $sql="select * from wbmydata";    // $datas=mysqli_query($con,$sql);    // $arr=mysqli_fetch_assoc($datas);    // echo "<pre>";      // echo json_encode($arr);    // echo "</pre>"    $act=$_GET["act"];    $pagesize=6;    switch ("add") {      case 'add':        $content=urldecode($_GET["content"]);        $time=date('Y-m-d H:i:s',time());        $content=str_replace("\n","",$content);        $sql="INSERT INTO wbmydata (id,content,time,acc,ref) VALUES(0,'$content','$time', 0, 0)";        mysqli_query($con,$sql);        $res=mysqli_query($con,'SELECT LAST_INSERT_ID()');            $row=mysqli_fetch_array($res);                $id=(int)$row[0];            echo "{\"error\": 0, \"id\": {$id}, \"time\": {$time}}";        break;      case 'get':            $page=$_GET["page"];           if($page<1){            $page=1;           }           $offset=($page-1)*$pagesize;           $sql="SELECT * from wbmydata LIMIT $offset,$pagesize";           $result=mysqli_query($sql);           $data=array();           while($row=mysqli_fetch_array($result)){              $arr=array();              array_push($arr, '"id":'.$row[0]);              array_push($arr, '"content":"'.$row[1].'"');              array_push($arr, '"time":'.$row[2]);              array_push($arr, '"acc":'.$row[3]);              array_push($arr, '"ref":'.$row[4]);              array_push($aResult, implode(',', $arr));           }           if(count($aResult)>0)            {              echo '[{'.implode('},{', $aResult).'}]';            }            else            {              echo '[]';            }            break;    }      ?>